knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(here)
data <- read_csv("dataset.csv")
data <- read_csv(here("dataset.csv"))
View(data)
lm(popularity ~ acousticness, data = data)
lm(popularity ~ acousticness, data = data) %>%
summary()
lm(popularity ~ instrumentalness data = data) %>%
lm(popularity ~ instrumentalness, data = data) %>%
summary()
lm(popularity ~ instrumentalness + explicit, data = data) %>%
summary()
lm(popularity ~ instrumentalness + explicit + valence + energy, data = data) %>%
summary()
lm(acousticness ~ energy + loudness, data = data) %>%
summary()
data <- read_csv(here("BankChurners.csv", "BankChurners.csv"))
View(data)
data$Attrition_Flag %>%
unique()
Attrition_Flag = "Attrited Customer" ~ 1)
new <- data %>%
mutate(exited = case_when(Attrition_Flag = "Existing Customer" ~ 0,
Attrition_Flag = "Attrited Customer" ~ 1)
)
new <- data %>%
mutate(exited = case_when(Attrition_Flag == "Existing Customer" ~ 0,
Attrition_Flag == "Attrited Customer" ~ 1))
View(new)
numeric <- new %>%
select(where(is.numeric(new)))
numeric <- new %>%
select_if(is.numeric)
cor(numeric)
View(numeric)
numeric <- new %>%
select_if(is.numeric) %>%
select(-Naive_Bayes_Classifier_Attrition_Flag_Card_Category_Contacts_Count_12_mon_Dependent_count_Education_Level_Months_Inactive_12_mon_1, -Naive_Bayes_Classifier_Attrition_Flag_Card_Category_Contacts_Count_12_mon_Dependent_count_Education_Level_Months_Inactive_12_mon_2)
cor(numeric)
cor(numeric) %>%
round(2)
cor(numeric) %>%
round(2) %>%
melt()
library(reshape2)
install.packages("reshape2")
library(reshape2)
cor(numeric) %>%
round(2) %>%
melt()
cor(numeric) %>%
round(2) %>%
melt() %>%
ggplot(aes(Var1, Var2, fill = Value)) +
geom_tile()
cor(numeric) %>%
round(2) %>%
melt() %>%
ggplot(aes(Var1, Var2, fill = value)) +
geom_tile()
cor(numeric) %>%
round(2) %>%
melt() %>%
ggplot(aes(Var1, Var2, fill = value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed()
cor(numeric) %>%
round(2) %>%
melt() %>%
ggplot(aes(Var1, Var2, fill = value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 3, hjust = 1))+
coord_fixed()
cor(numeric) %>%
round(2) %>%
melt() %>%
ggplot(aes(Var1, Var2, fill = value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1))+
coord_fixed()
lm(Total_Trans_Amt ~ Relationship_Count, data = numeric)
lm(Total_Trans_Amt ~ Total_Relationship_Count, data = numeric)
lm(Total_Trans_Amt ~ Total_Relationship_Count, data = numeric) %>%
summary()
cor(numeric) %>%
round(2) %>%
melt() %>%
ggplot(aes(Var1, Var2, fill = value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1))+
coord_fixed()
cor(data$Total_Relationship_Count, data$Total_Trans_Amt)
data <- data %>%
mutate(exited = case_when(Attrition_Flag == "Existing Customer" ~ 0,
Attrition_Flag == "Attrited Customer" ~ 1)) %>%
select(-Attrition_Flag,
-Naive_Bayes_Classifier_Attrition_Flag_Card_Category_Contacts_Count_12_mon_Dependent_count_Education_Level_Months_Inactive_12_mon_1,
-Naive_Bayes_Classifier_Attrition_Flag_Card_Category_Contacts_Count_12_mon_Dependent_count_Education_Level_Months_Inactive_12_mon_2)
library(tidyverse)
library(here)
library(reshape2)
data <- read_csv(here("BankChurners.csv", "BankChurners.csv"))
data <- data %>%
mutate(exited = case_when(Attrition_Flag == "Existing Customer" ~ 0,
Attrition_Flag == "Attrited Customer" ~ 1)) %>%
select(-Attrition_Flag,
-Naive_Bayes_Classifier_Attrition_Flag_Card_Category_Contacts_Count_12_mon_Dependent_count_Education_Level_Months_Inactive_12_mon_1,
-Naive_Bayes_Classifier_Attrition_Flag_Card_Category_Contacts_Count_12_mon_Dependent_count_Education_Level_Months_Inactive_12_mon_2)
data$Income_Category %>%
unique()
data %>%
ggplot(aes(x = Income_Category,
y = Total_Trans_Amt)) +
geom_bar()
data %>%
ggplot(aes(x = Income_Category,
y = Total_Trans_Amt)) +
geom_hist()
data %>%
ggplot(aes(x = Income_Category,
y = Total_Trans_Amt)) +
geom_histogram()
data %>%
ggplot(aes(x = Total_Trans_Amt)) +
geom_density()
data %>%
ggplot(aes(x = Total_Trans_Amt, color = Income_Category)) +
geom_histogram()
data %>%
ggplot(aes(x = Total_Trans_Amt)) +
geom_histogram()
data %>%
ggplot(aes(x = Total_Trans_Amt)) +
geom_histogram() +
facet_grid(.~Income_Category)
data %>%
ggplot(aes(x = Total_Trans_Amt)) +
geom_histogram() +
facet_grid(.~Income_Category, cols = 1)
data %>%
ggplot(aes(x = Total_Trans_Amt)) +
geom_histogram() +
facet_grid(.~Income_Category)
data %>%
ggplot(aes(x = Total_Trans_Amt)) +
geom_histogram() +
facet_wrap(Income_Category)
data %>%
ggplot(aes(x = Total_Trans_Amt)) +
geom_histogram() +
facet_wrap(~ Income_Category)
data %>%
ggplot(aes(x = Total_Trans_Amt, fill = Income_Category)) +
geom_density()
data %>%
ggplot(aes(x = Total_Trans_Amt)) +
geom_histogram() +
facet_wrap(~ Income_Category, nrow = 6)
data %>%
ggplot(aes(x = Total_Trans_Amt)) +
geom_histogram() +
facet_wrap(~ Income_Category)
data %>%
ggplot(aes(x = Total_Trans_Amt)) +
geom_histogram() +
facet_wrap(~ Education_Level)
data %>%
ggplot(aes(x = Total_Trans_Amt)) +
geom_histogram() +
facet_wrap(~ Marital_Status)
data %>%
ggplot(aes(x = Total_Trans_Amt)) +
geom_density() +
facet_wrap(~ Marital_Status)
data %>%
ggplot(aes(x = Total_Trans_Amt)) +
geom_density() +
facet_wrap(~ Education_Level)
data %>%
ggplot(aes(x = Total_Trans_Amt)) +
geom_density() +
facet_wrap(~ Income_Category)
data %>%
ggplot(aes(x = Total_Trans_Amt)) +
geom_histogram() +
facet_wrap(~ Income_Category)
data %>%
ggplot(aes(x = Total_Trans_Amt, fill = Income_Category)) +
geom_density()
data %>%
ggplot(aes(x = Total_Trans_Amt, fill = Income_Category)) +
geom_density(alpha = 0.5)
cor(data)
cor(data %>%
select_if(numeric))
cor(data %>%
select_if(is.numeric))
cor(data %>%
select_if(is.numeric)) %>%
round(2)
cor(data %>%
select_if(is.numeric) %>%
select(-CLIENTNUM)) %>%
round(2)
cor_matrix <- cor(data %>%
select_if(is.numeric) %>%
select(-CLIENTNUM)) %>%
round(2)
View(cor_matrix)
cor_matrix[,11]
cor_matrix %>%
as.data.frame()
cor_matrix %>%
as.data.frame() %>%
select(Total_Trans_Amt)
