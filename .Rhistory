select(-Naive_Bayes_Classifier_Attrition_Flag_Card_Category_Contacts_Count_12_mon_Dependent_count_Education_Level_Months_Inactive_12_mon_1,
-Naive_Bayes_Classifier_Attrition_Flag_Card_Category_Contacts_Count_12_mon_Dependent_count_Education_Level_Months_Inactive_12_mon_2,
-Gender,
-Attrition_Flag,
-CLIENTNUM)
data %>%
select_if(is.numeric) %>%
st(out = "return")
data %>%
select_if(is.numeric) %>%
cor() %>%
round(2) %>%
melt() %>%
ggplot(aes(Var1, Var2, fill = value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1))+
coord_fixed()
cor(data$Avg_Open_To_Buy, data$Credit_Limit)
data <- data %>%
select(-Avg_Open_To_Buy)
cor_matrix <- cor(data %>%
select_if(is.numeric)) %>%
round(2)
cor_matrix %>%
as.data.frame() %>%
select(Total_Trans_Ct) %>%
arrange(Total_Trans_Ct)
data %>%
ggplot(aes(x = Total_Trans_Ct)) +
geom_histogram()
data %>%
ggplot(aes(x = Total_Trans_Ct)) +
geom_histogram() +
facet_wrap(~ Income_Category, ncol = 1)
data %>%
ggplot(aes(x = Total_Trans_Ct)) +
geom_histogram() +
facet_wrap(~ Exited, nrow = 2)
data %>%
group_by(Total_Relationship_Count) %>%
summarise(mean(Total_Trans_Ct))
data %>%
ggplot(aes(x = as.factor(Total_Relationship_Count),
y = Total_Trans_Ct)) +
geom_bar(stat = "summary",
fun = mean,
fill = "dodgerblue")
data %>%
ggplot(aes(x = Total_Trans_Amt, y = Total_Trans_Ct, color = as.factor(Exited))) +
geom_point(alpha = 0.3) +
geom_smooth(method = "lm", formula = y ~ poly(x, 3), se = FALSE)
set.seed(9)
data$id <- 1:nrow(data)
training_data <- data %>%
sample_frac(0.7)
test_data <- data %>%
anti_join(training_data, by = 'id')
training_data2 <- training_data %>%
mutate(sqrt_total_trans_amt = sqrt(Total_Trans_Amt),
total_trans_ct_squared = Total_Trans_Ct^2)
training_data2 %>%
ggplot(aes(x = sqrt_total_trans_amt, y = total_trans_ct_squared)) +
geom_point()
training_data2 <- training_data2 %>%
mutate(sqrt_total_trans_ct = sqrt(Total_Trans_Ct))
training_data2 %>%
ggplot(aes(x = sqrt_total_trans_amt, y = sqrt_total_trans_ct)) +
geom_point()
training_data2 <- training_data2 %>%
mutate(total_trans_ct_transformed = Total_Trans_Ct^0.8)
training_data2 %>%
ggplot(aes(x = sqrt_total_trans_amt, y = total_trans_ct_transformed)) +
geom_point()
knitr::opts_chunk$set(echo = TRUE,
warning = FALSE,
message = FALSE)
library(tidyverse)
library(here)
library(reshape2)
library(vtable)
data <- read_csv(here("BankChurners.csv", "BankChurners.csv"))
data <- data %>%
mutate(Exited = case_when(Attrition_Flag == "Existing Customer" ~ 0,
Attrition_Flag == "Attrited Customer" ~ 1),
male = case_when(Gender == "M" ~ 1,
Gender == "F" ~ 0),
) %>%
select(-Naive_Bayes_Classifier_Attrition_Flag_Card_Category_Contacts_Count_12_mon_Dependent_count_Education_Level_Months_Inactive_12_mon_1,
-Naive_Bayes_Classifier_Attrition_Flag_Card_Category_Contacts_Count_12_mon_Dependent_count_Education_Level_Months_Inactive_12_mon_2,
-Gender,
-Attrition_Flag,
-CLIENTNUM)
data %>%
select_if(is.numeric) %>%
st(out = "return")
data %>%
select_if(is.numeric) %>%
cor() %>%
round(2) %>%
melt() %>%
ggplot(aes(Var1, Var2, fill = value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1))+
coord_fixed()
data %>%
select_if(is.numeric) %>%
cor() %>%
round(2) %>%
melt() %>%
ggplot(aes(Var1, Var2, fill = value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 25, vjust = 1,
size = 8, hjust = 1))+
coord_fixed()
data %>%
select_if(is.numeric) %>%
cor() %>%
round(2) %>%
melt() %>%
ggplot(aes(Var1, Var2, fill = value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 80, vjust = 1,
size = 8, hjust = 1))+
coord_fixed()
data %>%
select_if(is.numeric) %>%
cor() %>%
round(2) %>%
melt() %>%
ggplot(aes(Var1, Var2, fill = value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 80, vjust = 0,
size = 8, hjust = 1))+
coord_fixed()
data %>%
select_if(is.numeric) %>%
cor() %>%
round(2) %>%
melt() %>%
ggplot(aes(Var1, Var2, fill = value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 80, vjust = 1,
size = 8, hjust = 1))+
coord_fixed()
data %>%
select_if(is.numeric) %>%
cor() %>%
round(2) %>%
melt() %>%
ggplot(aes(Var1, Var2, fill = value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 0.5))+
coord_fixed()
data %>%
select_if(is.numeric) %>%
cor() %>%
round(2) %>%
melt() %>%
ggplot(aes(Var1, Var2, fill = value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 0))+
coord_fixed()
data %>%
select_if(is.numeric) %>%
cor() %>%
round(2) %>%
melt() %>%
ggplot(aes(Var1, Var2, fill = value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1.2))+
coord_fixed()
data %>%
select_if(is.numeric) %>%
cor() %>%
round(2) %>%
melt() %>%
ggplot(aes(Var1, Var2, fill = value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1.1))+
coord_fixed()
data %>%
select_if(is.numeric) %>%
cor() %>%
round(2) %>%
melt() %>%
ggplot(aes(Var1, Var2, fill = value)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1.1,
size = 8, hjust = 1.1))+
coord_fixed()
knitr::opts_chunk$set(echo = TRUE,
warning = FALSE,
message = FALSE)
library(tidyverse)
library(here)
library(reshape2)
library(vtable)
data <- read_csv(here("BankChurners.csv", "BankChurners.csv"))
data <- data %>%
mutate(Exited = case_when(Attrition_Flag == "Existing Customer" ~ 0,
Attrition_Flag == "Attrited Customer" ~ 1),
male = case_when(Gender == "M" ~ 1,
Gender == "F" ~ 0),
) %>%
select(-Naive_Bayes_Classifier_Attrition_Flag_Card_Category_Contacts_Count_12_mon_Dependent_count_Education_Level_Months_Inactive_12_mon_1,
-Naive_Bayes_Classifier_Attrition_Flag_Card_Category_Contacts_Count_12_mon_Dependent_count_Education_Level_Months_Inactive_12_mon_2,
-Gender,
-Attrition_Flag,
-CLIENTNUM)
descriptive_stats <- data %>%
select_if(is.numeric) %>%
st(out = "return")
descriptive_stats
data %>%
select_if(is.numeric) %>%
cor() %>%
round(2) %>%
melt() %>%
ggplot(aes(Var1, Var2, fill = value)) +
geom_tile(color = "white") +
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, vjust = 1.1, size = 8, hjust = 1.1),
axis.title.x = element_blank(),
axis.title.y = element_blank()) +
coord_fixed()
data %>%
select_if(is.numeric) %>%
cor() %>%
round(2) %>%
melt() %>%
ggplot(aes(Var1, Var2, fill = value)) +
geom_tile(color = "white") +
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, vjust = 1.1, size = 8, hjust = 1.1),
axis.title.x = element_blank(),
axis.title.y = element_blank()) +
coord_fixed() +
labs(title = "Correlation Matrix of All Numeric Variables")
cor(data$Avg_Open_To_Buy, data$Credit_Limit)
cor <- cor(data$Avg_Open_To_Buy, data$Credit_Limit)
print(cor)
cor <- cor(data$Avg_Open_To_Buy, data$Credit_Limit)
print("Correlation between these variables: ", cor)
print("Correlation between these variables: " + cor)
cor <- cor(data$Avg_Open_To_Buy, data$Credit_Limit)
cat("Correlation between these variables: ", cor)
cor <- cor(data$Avg_Open_To_Buy, data$Credit_Limit)
cat("Correlation between these variables:", cor)
data %>%
select_if(is.numeric) %>%
cor() %>%
round(2) %>%
melt() %>%
ggplot(aes(Var1, Var2, fill = value)) +
geom_tile(color = "white") +
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, vjust = 1.1, size = 8, hjust = 1.1),
axis.title.x = element_blank(),
axis.title.y = element_blank()) +
coord_fixed() +
labs(title = "Correlation Matrix of All Numeric Variables")
cor <- cor(data$Avg_Open_To_Buy, data$Credit_Limit)
cat("Correlation between these variables:", cor)
data <- data %>%
select(-Avg_Open_To_Buy)
cor_matrix <- cor(data %>%
select_if(is.numeric)) %>%
round(2)
cor_matrix %>%
as.data.frame() %>%
select(Total_Trans_Ct) %>%
arrange(Total_Trans_Ct)
data %>%
ggplot(aes(x = Total_Relationship_Count,
y= Total_Trans_Ct)) +
geom_point()
data %>%
ggplot(aes(x = Total_Relationship_Count,
y= Total_Trans_Ct)) +
geom_point(alpha = 0.1)
data %>%
ggplot(aes(x = Total_Relationship_Count,
y= Total_Trans_Ct)) +
geom_point(alpha = 0.05)
data %>%
ggplot(aes(x = Total_Trans_Ct)) +
geom_histogram(color = "dodgerblue") +
labs(x= "Total Transaction Count")
data %>%
ggplot(aes(x = Total_Trans_Ct)) +
geom_histogram(fill = "dodgerblue") +
labs(x= "Total Transaction Count")
data %>%
ggplot(aes(x = Total_Trans_Ct)) +
geom_histogram() +
facet_wrap(~ Income_Category, ncol = 1)
data %>%
ggplot(aes(x = Total_Trans_Ct)) +
geom_histogram(fill = "dodgerblue") +
labs(x= "Total Transaction Count",
title = "Distribution of Total Transaction Count")
data %>%
ggplot(aes(x = Total_Trans_Ct)) +
geom_histogram() +
facet_wrap(~ Income_Category, ncol = 1)
data %>%
ggplot(aes(x = Total_Trans_Ct)) +
geom_histogram() +
facet_wrap(~ Income_Category, ncol = 1) +
labs(x = "Total Transaction Count")
data %>%
ggplot(aes(x = Total_Trans_Ct)) +
geom_histogram() +
facet_wrap(~ Exited, nrow = 2, labeller = c("Did not Exit", "Exited"))
data %>%
ggplot(aes(x = Total_Trans_Ct)) +
geom_histogram() +
facet_wrap(~ Exited, nrow = 2, labeller = list("Did not Exit", "Exited"))
data %>%
ggplot(aes(x = Total_Trans_Ct)) +
geom_histogram() +
facet_wrap(~ Exited, nrow = 2, labeller = labeller(Exited = c("1234","2314")))
data %>%
ggplot(aes(x = Total_Trans_Ct)) +
geom_histogram() +
facet_wrap(~ Exited, nrow = 2, labeller = labeller(Exited = c("Did not","yes")))
data %>%
ggplot(aes(x = Total_Trans_Ct)) +
geom_histogram() +
facet_wrap(~ Exited, nrow = 2, labeller = labeller(~Exited = c("Did not","yes")))
data %>%
ggplot(aes(x = Total_Trans_Ct)) +
geom_histogram() +
facet_wrap(~ Exited, nrow = 2, labeller = labeller(Exited = c("Did not","yes")))
data %>%
ggplot(aes(x = Total_Trans_Ct)) +
geom_histogram() +
facet_wrap(~ Exited, nrow = 2) +
theme(axis.text.x = c("adfa", "fadsf"))
data %>%
ggplot(aes(x = Total_Trans_Ct)) +
geom_histogram() +
facet_wrap(~ Exited, nrow = 2)
data %>%
ggplot(aes(x = Total_Trans_Ct)) +
geom_histogram() +
facet_wrap(~ Exited, nrow = 2) +
labs(x = "Total Transaction Count",
title = "Distribution of Total Transaction Count by Exit Status")
data %>%
ggplot(aes(x = as.factor(Total_Relationship_Count),
y = Total_Trans_Ct)) +
geom_bar(stat = "summary",
fun = mean,
fill = "dodgerblue") +
labs(x = "Total Number of Products the Customer Has",
y= "Average Total Transaction Count")
data %>%
ggplot(aes(x = Total_Trans_Amt, y = Total_Trans_Ct, color = as.factor(Exited))) +
geom_point(alpha = 0.3) +
geom_smooth(method = "lm", formula = y ~ poly(x, 3), se = FALSE) +
labs(x = "Total Tranaction Count",
y = "Total Transaction Amount")
data %>%
ggplot(aes(x = Total_Trans_Amt, y = Total_Trans_Ct, color = as.factor(Exited))) +
geom_point(alpha = 0.3) +
geom_smooth(method = "lm", formula = y ~ poly(x, 3), se = FALSE) +
labs(x = "Total Tranaction Count",
y = "Total Transaction Amount") +
scale_fill_discrete(labels = c("Yes", "no"))
data %>%
ggplot(aes(x = Total_Trans_Amt, y = Total_Trans_Ct, color = as.factor(Exited))) +
geom_point(alpha = 0.3) +
geom_smooth(method = "lm", formula = y ~ poly(x, 3), se = FALSE) +
labs(x = "Total Tranaction Count",
y = "Total Transaction Amount") +
scale_color_manual(labels = c("Yes", "no"))
data %>%
ggplot(aes(x = Total_Trans_Amt, y = Total_Trans_Ct, color = as.factor(Exited))) +
geom_point(alpha = 0.3) +
geom_smooth(method = "lm", formula = y ~ poly(x, 3), se = FALSE) +
labs(x = "Total Tranaction Count",
y = "Total Transaction Amount") +
scale_color_manual(labels = c("Yes", "no"), values = c("blue", "red"))
data %>%
ggplot(aes(x = Total_Trans_Amt, y = Total_Trans_Ct, color = as.factor(Exited))) +
geom_point(alpha = 0.3) +
geom_smooth(method = "lm", formula = y ~ poly(x, 3), se = FALSE) +
labs(x = "Total Tranaction Count",
y = "Total Transaction Amount") +
scale_color_manual(labels = c("Yes", "no"), values = c("dodgerblue", "lime"))
data %>%
ggplot(aes(x = Total_Trans_Amt, y = Total_Trans_Ct, color = as.factor(Exited))) +
geom_point(alpha = 0.3) +
geom_smooth(method = "lm", formula = y ~ poly(x, 3), se = FALSE) +
labs(x = "Total Tranaction Count",
y = "Total Transaction Amount") +
scale_color_manual(labels = c("Yes", "no"), values = c("dodgerblue", "green"))
data %>%
ggplot(aes(x = Total_Trans_Amt, y = Total_Trans_Ct, color = as.factor(Exited))) +
geom_point(alpha = 0.3) +
geom_smooth(method = "lm", formula = y ~ poly(x, 3), se = FALSE) +
labs(x = "Total Tranaction Count",
y = "Total Transaction Amount") +
scale_color_manual(labels = c("Yes", "no"), values = c("dodgerblue", "pink"))
data %>%
ggplot(aes(x = Total_Trans_Amt, y = Total_Trans_Ct, color = as.factor(Exited))) +
geom_point(alpha = 0.3) +
geom_smooth(method = "lm", formula = y ~ poly(x, 3), se = FALSE) +
labs(x = "Total Tranaction Count",
y = "Total Transaction Amount") +
scale_color_manual(labels = c("Yes", "no"), values = c("dodgerblue", "orange"))
data %>%
ggplot(aes(x = Total_Trans_Amt, y = Total_Trans_Ct, color = as.factor(Exited))) +
geom_point(alpha = 0.3) +
geom_smooth(method = "lm", formula = y ~ poly(x, 3), se = FALSE) +
labs(x = "Total Tranaction Count",
y = "Total Transaction Amount") +
scale_color_manual(labels = c("Did not Exit", "Exited"), values = c("dodgerblue", "orange"))
data %>%
ggplot(aes(x = Total_Trans_Amt, y = Total_Trans_Ct, color = as.factor(Exited))) +
geom_point(alpha = 0.3) +
geom_smooth(method = "lm", formula = y ~ poly(x, 3), se = FALSE) +
labs(x = "Total Tranaction Count",
y = "Total Transaction Amount",
color = "adf") +
scale_color_manual(labels = c("Did not Exit", "Exited"), values = c("dodgerblue", "orange"))
data %>%
ggplot(aes(x = Total_Trans_Amt, y = Total_Trans_Ct, color = as.factor(Exited))) +
geom_point(alpha = 0.3) +
geom_smooth(method = "lm", formula = y ~ poly(x, 3), se = FALSE) +
labs(x = "Total Tranaction Count",
y = "Total Transaction Amount",
color = "Exit Status") +
scale_color_manual(labels = c("Did not Exit", "Exited"), values = c("dodgerblue", "orange"))
data %>%
ggplot(aes(x = Total_Trans_Amt, y = Total_Trans_Ct, color = as.factor(Exited))) +
geom_point(alpha = 0.3) +
geom_smooth(method = "lm", formula = y ~ poly(x, 3), se = FALSE) +
labs(x = "Total Tranaction Count",
y = "Total Transaction Amount",
color = "Exit Status",
title = "Third Degree Polynomial Smoother by Exit Status") +
scale_color_manual(labels = c("Did not Exit", "Exited"), values = c("dodgerblue", "orange"))
data %>%
ggplot(aes(x = Total_Trans_Amt, y = Total_Trans_Ct, color = as.factor(Exited))) +
geom_point(alpha = 0.3) +
geom_smooth(method = "lm", formula = y ~ poly(x, 3), se = FALSE) +
labs(x = "Total Tranaction Count",
y = "Total Transaction Amount",
color = "Exit Status",
title = "Third Degree Polynomial Smoother for Customers who did and did not Exit") +
scale_color_manual(labels = c("Did not Exit", "Exited"), values = c("dodgerblue", "orange"))
